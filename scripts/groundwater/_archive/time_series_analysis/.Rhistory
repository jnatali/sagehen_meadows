discharge_grid <- discharge_grid %>%
left_join(discharge, by = "year_week")
# transform to timesteps as columns
discharge_matrix <- discharge_grid %>%
pivot_wider(
names_from = year_week,
values_from = flow_cfs
)
# check completeness
discharge_matrix %>%
summarize(
na_sum = sum(across(everything(), ~ is.na(.))),
na_percent = 100 * na_sum / (n() * ncol(.))
)
# Convert to matrix, validate and check dimensions
discharge_matrix <- as.matrix(discharge_matrix)
class(discharge_matrix)
dim(discharge_matrix)
# Z-score flow values
discharge_covariate <- zscore(discharge_matrix)
return(discharge_covariate)
}
#### BUILD Z MATRICES
# by: JNatali
# on: 17 Nov 2024
# purpose: sets up Z matrices for the model runs,
#          returns them as a list of matrices
# returns: z_matrix_list, a list of matrices
# TODO: Consider other Z matrices:
#           SITE x PFT x HGMZ combo
#           well distance from Sagehen Creek (well across a transect)
# TODO: Use dynamic factor analysis to improve categorization of HGMZ / PFT
#       address uncertainty about categorization; see MARSS User Guide Ch 10.
get_z_matrices <- function(gw_data) {
## MEADOW SITES ##
# 3 meadow sites (Kiln, East, Lo); each is its own state, an independent dimension
Z_site = matrix(NA, nrow=0, ncol=3)
# --- loop thru well_ids to determine meadow site
for (i in 1:nrow(gw_data)) {
well_id <- gw_data[i,1]
meadow <- substring(well_id, 1, 1)
#print(meadow)
if (meadow == "E") {
row <- c(1, 0, 0)
} else if (meadow == "K") {
row <- c(0, 1, 0)
} else if (meadow == "L") {
row <- c(0, 0, 1)
} else print("WARNING: Well Meadow Site is NOT E, K, or L")
Z_site <- rbind(Z_site, row)
}
dim(Z_site)
## PLANT FUNCTIONAL TYPES ##
# PFT x 4 (sedge, willow, mixed herbaceous, pine)
Z_pft = matrix(NA, nrow=0, ncol=4)
# --- loop thru well_ids to determine PFT
for (i in 1:nrow(gw_data)) {
well_id <- gw_data[i,1]
pft <- substring(well_id, 2, 2)
#print(pft)
if (pft == "E") {
row <- c(1, 0, 0, 0)
} else if (pft == "W") {
row <- c(0, 1, 0, 0)
} else if (pft == "H") {
row <- c(0, 0, 1, 0)
} else if (pft == "F") {
row <- c(0, 0, 0, 1)
} else print("WARNING: Well PFT is NOT E, W, H or F")
Z_pft <- rbind(Z_pft, row)
}
dim(Z_pft)
## HYDROGEOMORPHIC ZONES ##
# HGMZ x 3 (riparian, terrace, fan)
Z_hgmz = matrix(NA, nrow=0, ncol=3)
# --- loop thru well_ids to determine PFT
for (i in 1:nrow(gw_data)) {
well_id <- gw_data[i,1]
hgmz <- substring(well_id, 3, 3)
#print(hgmz)
if (hgmz == "R") {
row <- c(1, 0, 0)
} else if (hgmz == "T") {
row <- c(0, 1, 0)
} else if (hgmz == "F") {
row <- c(0, 0, 1)
} else print("WARNING: Well HGMZ is NOT R, T, or F")
Z_hgmz <- rbind(Z_hgmz, row)
}
dim(Z_hgmz)
## STRATIFIED COMBO ##
# PFT x HGMZ (3x4 = 12 combos)
Z_pftXhgmz = matrix(0, nrow=dim(gw_data)[1], ncol=12)
colnames(Z_pftXhgmz) <- c("ER", "ET", "EF", "WR", "WT", "WF", "HR", "HT", "HF", "FR", "FT", "FF")
# --- loop thru well_ids to determine PFT x HGMZ
for (i in 1:nrow(gw_data)) {
well_id <- gw_data[i,1]
combo <- substring(well_id, 2, 3)
# Find the column that matches the PFT x HGMZ combo characters
col_index <- which(colnames(Z_pftXhgmz) == combo)
if (length(col_index) == 1) { # if combo is valid
Z_pftXhgmz[i, col_index] <- 1 # assign to 1
}
}
dim(Z_pftXhgmz)
## CREATE LIST OF MATRICES AND RETURN
Z_matrix_list <- list(Z_site, Z_pft, Z_hgmz, Z_pftXhgmz)
return(Z_matrix_list)
}
#### SPECIFY MARSS PARAMS
# by: JNatali
# on: 17 Nov 2024
# purpose: read params from a csv or xls file for a set of models
#          will only read models to run for today's date (runtime)
# returns: param_dataframe
get_model_parameters <- function(start_number, end_number) {
# read parameter file as a dataframe, format data using lubridate
params <- read.csv(model_parameter_filepath)
params$run_date <- mdy(params$run_date)
# filter params to run models for today
filter_date <- today
# check if start and stop IDs are missing or present, then filter
if (!missing(start_number) && !missing(stop_number)){
# filter for today and specified model #s
params <- params %>%
filter(run_date == filter_date, ID >= start_number, ID <= stop_number)
} else {
# filter by date only
params <- params %>%
filter(run_date == filter_date)
}
return(params)
}
#### RUN A SINGLE MODEL
# by: JNatali
# on: 17 Nov 2024
# purpose: run a single models and track runtime
# returns: model_result, a dataframe with model summary stats (from glance())
#                         and model runtime
run_single_model <- function(response_matrix, param_list, model_id){
# set max iterations
number_iterations <- 10000
# Track runtime
start_time <- Sys.time()
# Fit the model
model <- MARSS(response_matrix, model = param_list, control=list(maxit=number_iterations))
# Track runtime
end_time <- Sys.time()
execution_minutes <- as.numeric(difftime(end_time, start_time, units = "mins"))
# Save model summary as a csv
model_summary <- tidy(model)
# identify model_id and date in filename
model_summary_filename = paste(formatted_date,"_",model_id,
"_summary.csv",sep='')
# leverage directory names set at top of file
model_summary_filepath = paste(repository_dir, marss_script_dir,
model_summary_filename,
sep='')
write.csv(model_summary,model_summary_filepath, row.names=FALSE)
# generate model results stats
model_stats <- glance(model)
# return for analysis of full set of model runs
return(cbind(model_stats, run_minutes = execution_minutes))
}
#### RUN ALL THE MODELS
# by: JNatali
# on: 17 Nov 2024
# purpose: run through all the models in the parameter setup csv,
#          generate and save results
# returns: model_dataframe
run_all_models <- function(response_matrix) {
### SETUP THE MODEL RUNS ###
# setup the results dataframe
results_dataframe <- data.frame()
# get the params for the runs
model_param_dataframe <- get_model_parameters() # today's runs in the csv
param_list_columns <- c("Z", "R", "U", "B", "Q", "C", "A")
# LOOP through each row of the model IDs and params
for (i in 1:nrow(model_param_dataframe)) {
# GET model parameters and name them appropriately
row <- model_param_dataframe[i, param_list_columns, drop=FALSE]
param_list <- as.list(row)
names(param_list) <- param_list_columns
### PREP THE RESPONSE MATRIX (groundwater data) ###
# GET completeness param and filter matrix
response_matrix <- filter_incomplete_wells(response_matrix,
model_param_dataframe$completeness)
# remove header row and well_id column from response_matrix
colnames(response_matrix) <- NULL
response_matrix <- response_matrix[,-1]
number_states <- nrow(response_matrix)
# ensure it's all numeric
response_matrix <- apply(response_matrix, 2, as.numeric)
# RUN the model with the appropriate params,
#     it'll return the result and runtime as a dataframe
model_result_dataframe <- run_single_model(response_matrix,
param_list,
model_param_dataframe$ID)
# ASSIGN model ID and date to the result dataframe
new_result_row <- data.frame(
ID = model_param_dataframe$ID,
run_date = model_param_dataframe$run_date,
states = number_states,
completeness = completeness_limit,
stringsAsFactors = FALSE)
# Merge with "glance" summary from model run
merged_results <- merge(new_result_row,
model_result_dataframe, # "glance" dataframe + run_minutes
by = NULL)
# reorder columns
merged_results <- merged_results[, c("ID", "run_date", "run_minutes",
"states", "completeness",
"AIC", "AICc",
setdiff(names(merged_results),
c("ID", "run_date",
"run_minutes", "states",
"completeness",
"AIC", "AICc")))]
results_dataframe <- rbind(results_dataframe, merged_results)
}
# save all results in csv
start_id <- min(results_dataframe$ID)
end_id <- max(results_dataframe$ID)
# identify model_id and date in filename
model_stats_filename = paste(formatted_date,"_",
start_id,"to",end_id,
"_stats.csv",sep='')
# leverage directory names set at top of file
model_stats_filepath = paste(repository_dir, marss_script_dir,
model_stats_filename,
sep='')
write.csv(results_dataframe,model_stats_filepath, row.names=FALSE)
# return results
return(results_dataframe)
}
#### ASSESS THE MODELS
# by: JNatali
# on: 17 Nov 2024
# purpose: plot and compare model results, evaluate hypotheses
# returns:
# NOT YET DEFINED
# ------ MAIN PROCEDURAL SCRIPT ------
groundwater_data <- prepare_groundwater_data()
View(groundwater_data)
response_matrix <- load_response_data(groundwater_data)
View(response_matrix)
Z <- get_z_matrices(response_matrix)
results_dataframe <- run_all_models(response_matrix)
View(response_matrix)
### SETUP THE MODEL RUNS ###
# setup the results dataframe
results_dataframe <- data.frame()
# get the params for the runs
model_param_dataframe <- get_model_parameters() # today's runs in the csv
param_list_columns <- c("Z", "R", "U", "B", "Q", "C", "A")
for (i in 1:nrow(model_param_dataframe)) {
# GET model parameters and name them appropriately
row <- model_param_dataframe[i, param_list_columns, drop=FALSE]
param_list <- as.list(row)
names(param_list) <- param_list_columns
}
i=1
row <- model_param_dataframe[i, param_list_columns, drop=FALSE]
param_list <- as.list(row)
names(param_list) <- param_list_columns
filter_incomplete_wells(response_matrix,
model_param_dataframe$completeness)
model_param_dataframe$completeness
model_param_dataframe[i,completeness]
View(model_param_dataframe)
model_param_dataframe$completeness[i]
source("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater.R")
source("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater.R")
source("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater.R")
##########  GROUNDWATER MARSS ANALYSIS SCRIPT  ##########
# Author: Jennifer Natali, jennifer.natali@berkeley.edu
# Date Created: Sunday 17 November 2024
#
# This script sets up and executes MARSS model(s) for groundwater level data.
#
# This code is under development and follows a functional programming paradigm.
#
# Requires  data files:
# 1. RAW groundwater data (in cm) for all years: 'groundwater_biweekly_RAW.csv'
#
# TODOs documented in github repo issue tracking.
groundwater_data <- prepare_groundwater_data()
response_matrix <- load_response_data(groundwater_data)
Z <- get_z_matrices(response_matrix)
### SETUP THE MODEL RUNS ###
# setup the results dataframe
results_dataframe <- data.frame()
# get the params for the runs
model_param_dataframe <- get_model_parameters() # today's runs in the csv
param_list_columns <- c("Z", "R", "U", "B", "Q", "C", "A")
i=1
row <- model_param_dataframe[i, param_list_columns, drop=FALSE]
param_list <- as.list(row)
names(param_list) <- param_list_columns
c=model_param_dataframe$completeness[i]
limit
limit=c
limit
missing(limit)
if (missing(limit)) limit <- completeness_limit
limit
total_rows <- nrow(groundwater_matrix)
groundwater_mtarix = response_matrix
View(groundwater_mtarix)
total_rows <- nrow(groundwater_matrix)
new_groundwater_matrix <- groundwater_matrix[na_percent <= limit, ]
groundwater_matrix <- response_matrix
total_rows <- nrow(groundwater_matrix)
total_columns <- ncol(groundwater_matrix)
na_sums <- rowSums(is.na(groundwater_matrix))
na_percent <- rowSums(is.na(groundwater_matrix)) / total_columns
groundwater_matrix$well_id
new_groundwater_matrix <- groundwater_matrix[na_percent <= limit, ]
View(new_groundwater_matrix)
print(paste0('ALERT: # of rows removed after completeness check: ',
total_rows - nrow(new_groundwater_matrix)))
removed_wells <- setdiff(groundwater_matrix$well_id,
new_groundwater_matrix$well_id)
groundwater_matrix$well_id
View(groundwater_matrix)
View(groundwater_mtarix)
View(groundwater_matrix)
setdiff(groundwater_matrix$well_id,
new_groundwater_matrix$well_id)
class(groundwater_matrix)
groundwater_matrix <- as.data.frame(groundwater_matrix)
new_groundwater_matrix <- groundwater_matrix[na_percent <= limit, ]
setdiff(groundwater_matrix$well_id,
new_groundwater_matrix$well_id)
debugSource("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater.R")
source("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater.R")
gc()
# return for analysis of full set of model runs
return(cbind(model_stats, run_minutes = execution_minutes))
source("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater.R")
source("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater.R")
source("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater.R")
source("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater.R")
source("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater.R")
trim_first_two_weeks
View(groundwater_data)
groundwater_data
groundwater_data[, -c(1,2)]
source("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater.R")
source("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater.R")
source("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater.R")
View(groundwater_data)
View(groundwater_data)
View(groundwater_data)
source("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater.R")
source("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater.R")
# ------ INITIALIZE GLOBAL VARIABLES ------
#### Info about the data
year_range <- c(2018, 2019, 2021, 2024)
source("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater.R")
source("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater.R")
source("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater.R")
View(response_matrix)
install.packages(c("foreach", "doParallel"))
install.packages("discharge")
source("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater_v3.R")
stopCluster(clusters)
debugSource("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater_v3.R")
stopCluster(clluster)
stopCluster(cluster)
source("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater_v2.R")
timespan_param
debugSource("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater_v2.R")
i
model_param_dataframe$timespan[i]
debugSource("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater_v2.R")
source("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater_v2.R")
source("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater_v2.R")
source("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater_v2.R")
debugSource("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater_v2.R")
View(year_response_matrix)
View(response_matrix)
debugSource("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater_v2.R")
View(year_response_matrix)
debugSource("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater_v2.R")
debugSource("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater_v2.R")
debugSource("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater_v2.R")
debugSource("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater_v2.R")
force(model_param_dataframe)
View(model_param_dataframe)
force(model_ID)
source("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater_v2.R")
View(process_model_results)
debugSource("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater_v2.R")
View(year_response_matrix)
View(year_response_matrix)
model_ID
year
model_ID_year
model_ID_year
yaer
year
View(year_response_matrix)
source("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater_v2.R")
source("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater_v2.R")
source("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater_v2.R")
source("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater_v2.R")
source("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater_v2.R")
source("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater_v2.R")
source("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater_v2.R")
source("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater_v2.R")
source("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater_v2.R")
source("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater_v2.R")
debugSource("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater_v2.R")
force(response_matrix)
View(response_matrix)
debugSource("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater_v2.R")
debugSource("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater_v2.R")
force(response_matrix)
View(response_matrix)
source("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater_v2.R")
debugSource("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater_v2.R")
View(response_matrix)
View(response_matrix)
debugSource("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater_v2.R")
# ------ INITIALIZE GLOBAL VARIABLES ------
#### Info about the data
#year_range <- c(2018, 2019, 2021, 2024)
year_range <- c(2024)
source("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater_v2.R")
source("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater_v2.R")
source("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater_v2.R")
source("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater_v2.R")
debugSource("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater_v2.R")
weekly_matrix
View(weekly_matrix)
debugSource("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater_v2.R")
force(response_matrix)
View(response_matrix)
debugSource("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater_v2.R")
force(response_matrix)
View(response_matrix)
debugSource("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater_v2.R")
force(response_matrix)
View(row)
View(response_matrix)
View(model_response_matrix)
View(year_response_matrix)
debugSource("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater_v2.R")
View(response_matrix)
View(model_response_matrix)
as.data.frame(model_response_matrix) %>%
select(matches(paste0("^", year)))
View(model_response_matrix)
View(response_matrix)
View(response_matrix)
colnames(response_matrix)
colnames(model_response_matrix)
debugSource("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater_v2.R")
View(weekly_matrix)
debugSource("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater_v2.R")
View(weekly_matrix)
debugSource("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater_v2.R")
View(weekly_matrix)
View(year_response_matrix)
MARSSinfo("HessianNA")
debugSource("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater_v2.R")
debugSource("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater_v2.R")
debugSource("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater_v2.R")
source("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater_v2.R")
source("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater_v2.R")
debugSource("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater_v2.R")
View(response_matrix)
View(response_matrix)
param_list
model <- MARSS(response_matrix, model=param_list, control=list(maxit=number_iterations, trace=1, safe=TRUE))
number_iterations
model <- MARSS(response_matrix, model=param_list, control=list(maxit=number_iterations)
)
source("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater_v2.R")
source("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater_v2.R")
source("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater_v2.R")
source("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater_v2.R")
source("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater_v2.R")
source("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater_v2.R")
source("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater_vfullgapsBetweenYrs.R")
source("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater_vfullgapsBetweenYrs.R")
timespan_param
timespan_param <- 'continuous'
timespan_param == 'each year'
if (timespan_param == 'each year') { print("TRUE") } else { print("FALSE")}
debugSource("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater_vfullgapsBetweenYrs.R")
debugSource("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater_vfullgapsBetweenYrs.R")
timespan_param
i
View(model_param_dataframe)
nrow(model_param_dataframe)
debugSource("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater_vfullgapsBetweenYrs.R")
debugSource("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater_vfullgapsBetweenYrs.R")
source("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater_vfullgapsBetweenYrs.R")
debugSource("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater_vfullgapsBetweenYrs.R")
i
model_param_dataframe[i]
model_param_dataframe[i,,drop=FALSE]
source("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater_vfullgapsBetweenYrs.R")
View(response_matrix)
source("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater_vfullgapsBetweenYrs.R")
source("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater_vfullgapsBetweenYrs.R")
source("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater_vfullgapsBetweenYrs.R")
source("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater_vfullgapsBetweenYrs.R")
source("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater_vfullgapsBetweenYrs.R")
source("/Volumes/SANDISK_SSD_G40/GoogleDrive/GitHub/sagehen_meadows/scripts/groundwater/MARSS_Sagehen_Groundwater_vfullgapsBetweenYrs.R")
